# Application Configuration
spring.application.name=Dietician API

# Server Configuration
server.port=8080
server.servlet.context-path=/api

# Database Configuration
spring.datasource.url=jdbc:postgresql://localhost:5432/dietician_db?currentSchema=diet&ssl=false
spring.datasource.username=${DB_USERNAME:dietician_user}
spring.datasource.password=${DB_PASSWORD:dietician_password}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA Configuration
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
# Dialect is auto-detected for PostgreSQL, no need to specify explicitly
spring.jpa.properties.hibernate.format_sql=true

# Flyway Configuration
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration

# Mail Configuration
# Active profile: Set 'dev' for local (MailHog) or 'prod' for production (Mailcow)
# Default is dev (MailHog)
spring.profiles.active=${SPRING_PROFILES_ACTIVE:dev}

# Default Mail Configuration (overridden by profiles)
spring.mail.from=${MAIL_FROM:noreply@localhost}


# OAuth2 Configuration (Google)
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID:your-client-id}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET:your-client-secret}
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/api/auth/oauth2/callback/{registrationId}

# JWT Configuration
jwt.secret=${JWT_SECRET:cyvzR8gr4xi8yMUwDlOF5uLRNxBd8cUkKffcqj4uTXc=}
jwt.expiration=86400000
jwt.refresh-expiration=604800000

# Encryption Configuration
encryption.key=${ENCRYPTION_KEY:iMyMrLoy3YD2GJVLh/n14ve4g4kWMc3h6rGh1CQm/QY=}

# CORS Configuration
cors.allowed-origins=${CORS_ORIGINS:http://localhost:3000,http://localhost:8081}

# File Upload Configuration
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=5MB
app.upload.dir=/var/dietician/uploads

# Logging
logging.level.com.dietician=DEBUG
logging.level.org.springframework.security=DEBUG

#
# ===============================================
# =	TOMCAT
# ===============================================

server.tomcat.accept-count=100
server.tomcat.max-connections=500
server.tomcat.max-http-form-post-size=2097152
server.tomcat.max-swallow-size=2
server.tomcat.threads.max=100
server.tomcat.threads.min-spare=100
server.tomcat.remoteip.host-header=X-Forwarded-Port

# NOTE: Using /var/log/dietician as permissions have been granted
server.tomcat.accesslog.buffered=true
server.tomcat.accesslog.directory=/var/log/dietician/access
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.file-date-format=-dd-MM-yyyy
server.tomcat.accesslog.pattern=%h %l %u %t "%r" %s %b %T %F %I
server.tomcat.accesslog.prefix=access_log-${server.port}
server.tomcat.accesslog.rename-on-rotate=false
server.tomcat.accesslog.request-attributes-enabled=false
server.tomcat.accesslog.rotate=true
server.tomcat.accesslog.suffix=.log

logging.level.root=INFO

# Using /var/log/dietician
logging.file.name=/var/log/dietician/dietician-${server.port}.log
logging.file.max-history=10
logging.file.max-size=50MB
